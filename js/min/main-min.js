function error(e){console.log(e)}function execute(e){worker.onmessage=function(e){var t=e.data.results;outputElm.innerHTML="";for(var n=0;n<t.length;n++)outputElm.appendChild(tableCreate(t[n].columns,t[n].values));console.log(JSON.stringify(t[0].values)),console.log(JSON.stringify(t[0].values[3]))},worker.postMessage({action:"exec",sql:e})}function jsonCreate(e){var t=JSON.stringify(e[0]),n=JSON.stringify(e[1]),r=JSON.stringify(e[2]),o=JSON.stringify(e[3]),s=JSON.stringify(e[4]),a=JSON.stringify(e[5])}function execEditorContents(){var e="SELECT * FROM windowevent; ";execute(e)}function savedb(){worker.onmessage=function(e){toc("Exporting the database");var t=e.data.buffer,n=new Blob([t]),r=window.URL.createObjectURL(n);window.location=r},tic(),worker.postMessage({action:"export"})}var execBtn=document.getElementById("execute"),outputElm=document.getElementById("output"),errorElm=document.getElementById("error"),commandsElm=document.getElementById("commands"),dbFileElm=document.getElementById("dbfile"),savedbElm=document.getElementById("savedb"),workerPath="../bower_components/sql.js/js/worker.sql.js",worker=new Worker(workerPath);worker.onerror=error,worker.postMessage({action:"open"});var tableCreate=function(){function e(e,t){if(0===e.length)return"";var n="<"+t+">",r="</"+t+">";return n+e.join(r+n)+r}return function(t,n){var r=document.createElement("table"),o="<thead>"+e(t,"th")+"</thead>",s=n.map(function(t){return e(t,"td")});return o+="<tbody>"+e(s,"tr")+"</tbody>",r.innerHTML=o,r}}();execBtn.addEventListener("click",execEditorContents,!0),dbFileElm.onchange=function(){var e=dbFileElm.files[0],t=new FileReader;t.onload=function(){worker.onmessage=function(){execEditorContents()};try{worker.postMessage({action:"open",buffer:t.result},[t.result])}catch(e){worker.postMessage({action:"open",buffer:t.result})}},t.readAsArrayBuffer(e)},savedbElm.addEventListener("click",savedb,!0);